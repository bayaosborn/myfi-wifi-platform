<!-- contact.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MyFi Contacts</title>
    

<link rel="stylesheet" href="/static/css/contacts.css">

    
</head>
<body>
    <h1>Contacts</h1>


    

<!-- Carousel -->
<div class="carousel-container">
    <div class="carousel" id="tag-carousel">
        <!-- Tag buttons will be injected here -->
    </div>
</div>

<!-- Contacts container -->
<div id="contacts-container"></div>






    
    
    
<!--
    <script>
        async function contacts() {
            try {
                const response = await fetch('/api/contacts', { method: 'GET' });
                const data = await response.json();

                const container = document.getElementById('contacts-container');
                container.innerHTML = ''; // clear previous

                if (data.contacts && data.contacts.length > 0) {
                    data.contacts.forEach(contact => {
                        const div = document.createElement('div');
                        div.className = 'contact-card';
                        div.innerHTML = `
                            <span>${contact.name || 'No Name'}</span>
                            <span>${contact.phone || ''}</span>
                        `;
                        container.appendChild(div);
                    });
                } else {
                    container.innerHTML = '<p>No contacts found.</p>';
                }

            } catch (error) {
                console.error('Error fetching contacts:', error);
                document.getElementById('contacts-container').innerHTML = '<p>Error loading contacts.</p>';
            }
        }

        // Fetch contacts when page loads
        window.addEventListener('DOMContentLoaded', contacts);
    </script>
-->


    <script>
        let allContacts = [];  // stores all contacts
let filteredContacts = []; // filtered contacts
let carouselInterval;  // carousel animation
let tags = ["All", "Family", "Relationships", "Riders", "Friends", "Work"]; // list of tags

// Fetch contacts from API
async function fetchContacts() {
    try {
        const response = await fetch('/api/contacts', { method: 'GET' });
        const data = await response.json();
        allContacts = data.contacts || [];
        filteredContacts = allContacts;
        renderContacts(filteredContacts);
        renderCarousel();
        startCarousel();
    } catch (error) {
        console.error("Error fetching contacts:", error);
    }
}

// Render contacts on page
function renderContacts(contacts) {
    const container = document.getElementById('contacts-container');
    container.innerHTML = '';

    if (!contacts.length) {
        container.innerHTML = '<p>No contacts found.</p>';
        return;
    }

    contacts.forEach(contact => {
        const div = document.createElement('div');
        div.className = 'contact-card';
        div.innerHTML = `
            <span>${contact.name || 'No Name'}</span>
            <span>${contact.phone || ''}</span>
        `;
        container.appendChild(div);
    });
}

// Render tag carousel
function renderCarousel() {
    const carousel = document.getElementById('tag-carousel');
    carousel.innerHTML = '';

    tags.forEach(tag => {
        const button = document.createElement('button');
        button.textContent = tag;
        button.onclick = () => filterByTag(tag);
        carousel.appendChild(button);
    });
}

// Filter contacts by tag
function filterByTag(tag) {
    stopCarousel();

    const carouselButtons = document.querySelectorAll('.carousel button');
    carouselButtons.forEach(btn => btn.classList.remove('active'));

    const clickedButton = [...carouselButtons].find(btn => btn.textContent === tag);
    if (clickedButton) clickedButton.classList.add('active');

    if (tag === "All") {
        filteredContacts = allContacts;
    } else {
        filteredContacts = allContacts.filter(c => c.tag.toLowerCase() === tag.toLowerCase());
    }

    renderContacts(filteredContacts);
}

// Automatic carousel scroll
function startCarousel() {
    const carousel = document.getElementById('tag-carousel');
    let scrollAmount = 0;

    carouselInterval = setInterval(() => {
        scrollAmount += 1;
        if (scrollAmount >= carousel.scrollWidth - carousel.clientWidth) {
            scrollAmount = 0;
        }
        carousel.scrollTo({
            left: scrollAmount,
            behavior: 'smooth'
        });
    }, 50); // adjust speed (lower = faster)
}

// Stop carousel
function stopCarousel() {
    clearInterval(carouselInterval);
}

// Initialize
window.addEventListener('DOMContentLoaded', fetchContacts);
    </script>
</body>
</html>