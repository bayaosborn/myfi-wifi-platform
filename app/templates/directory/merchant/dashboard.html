<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ merchant.business_name }} - Dashboard</title>
    <link rel="stylesheet" href="/static/css/directory/merchant/dashboard.css">
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <nav class="nav-tabs">
            <a href="/directory/merchant/dashboard" class="nav-tab active">Dashboard</a>
            <a href="/directory/merchant/products" class="nav-tab">Products</a>
            <a href="/directory/merchant/orders" class="nav-tab">Orders</a>
            <a href="/directory/merchant/settings" class="nav-tab">Settings</a>
        </nav>

        <!-- Header -->
        <div class="header">
            <div>
                <h1>{{ merchant.business_name }}</h1>
                <p class="subtitle">{{ merchant.owner_name }} ‚Ä¢ {{ merchant.category|capitalize }}</p>
            </div>
            <div class="header-actions">
                <span class="merchant-id">ID: {{ merchant.id[:8] }}</span>
            </div>
        </div>

        <!-- Status Controls -->
        <div class="status-section">
            <h2>Business Status</h2>
            
            <div class="status-controls">
                <!-- Operational Status -->
                <div class="status-card">
                    <div class="status-label">Store Status</div>
                    <div class="status-buttons">
                        <button 
                            class="btn btn-open {% if merchant.status == 'OPEN' %}active{% endif %}" 
                            data-field="status" 
                            data-value="OPEN"
                        >
                            ‚úÖ OPEN
                        </button>
                        <button 
                            class="btn btn-closed {% if merchant.status == 'CLOSED' %}active{% endif %}" 
                            data-field="status" 
                            data-value="CLOSED"
                        >
                            ‚ùå CLOSED
                        </button>
                    </div>
                </div>

                <!-- Stock Status -->
                <div class="status-card">
                    <div class="status-label">Stock Status</div>
                    <div class="status-buttons">
                        <button 
                            class="btn btn-in-stock {% if merchant.stock_status == 'IN_STOCK' %}active{% endif %}" 
                            data-field="stock_status" 
                            data-value="IN_STOCK"
                        >
                            üì¶ IN STOCK
                        </button>
                        <button 
                            class="btn btn-out-stock {% if merchant.stock_status == 'OUT_OF_STOCK' %}active{% endif %}" 
                            data-field="stock_status" 
                            data-value="OUT_OF_STOCK"
                        >
                            üö´ OUT OF STOCK
                        </button>
                    </div>
                </div>
            </div>

            <!-- Current Status Display -->
            <div class="current-status {% if merchant.status == 'CLOSED' or merchant.stock_status == 'OUT_OF_STOCK' %}closed{% endif %}">
                <div class="status-text">
                    Current: {{ merchant.status }} ‚Ä¢ {{ merchant.stock_status }}
                </div>
                <p class="status-help">
                    {% if merchant.status == 'OPEN' and merchant.stock_status == 'IN_STOCK' %}
                        ‚úÖ Your business is discoverable by customers via Logic
                    {% else %}
                        ‚ö†Ô∏è Customers won't be able to find you in searches
                    {% endif %}
                </p>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">{{ orders|length }}</div>
                <div class="stat-label">Total Orders</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ merchant.rating or 0 }}</div>
                <div class="stat-label">Rating</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ products_count or 0 }}</div>
                <div class="stat-label">Products</div>
            </div>
        </div>

        <!-- Recent Orders -->
        <div class="orders-section">
            <div class="section-header">
                <h2>Recent Orders</h2>
                <a href="/directory/merchant/orders" class="view-all">View All ‚Üí</a>
            </div>
            
            <div class="order-list">
                {% if orders %}
                    {% for order in orders[:5] %}
                    <div class="order-item">
                        <div class="order-header">
                            <span class="order-id">Order #{{ order.id[:8] }}</span>
                            <span class="order-status {{ order.status|lower }}">
                                {{ order.status }}
                            </span>
                        </div>
                        <div class="order-details">
                            {{ order.created_at }} ‚Ä¢ KES {{ order.total_amount or 0 }}
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <div class="empty-icon">üì¶</div>
                        <p class="empty-title">No orders yet</p>
                        <p class="empty-text">Orders will appear here once customers start ordering</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notification" class="notification"></div>

    <script src="/static/js/directory/merchant/dashboard.js"></script>
</body>
</html>